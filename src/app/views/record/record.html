<div layout="row" class="loading-overlay" ng-show="$ctrl.loading" layout-align="center center">
  <md-progress-circular md-mode="indeterminate"></md-progress-circular>
</div>
<div layout="column" class="record-detail" ng-show="!$ctrl.loading">
  <h2>{{$ctrl.record.entity}} {{$ctrl.getIdentifier($ctrl.record)}}</h2>

  <div class="main-details" layout="row" layout-align="center center">
    <table flex class="table table-condensed">
      <tbody>
        <tr ng-repeat="(key, value) in $ctrl.mainRecordDetails() track by key">
          <th>{{key}}:</th>
          <td ng-if="value.href" class="truncate">
            <a href="{{value.href}}" target="_blank">{{value.text}}</a>
          </td>
          <td ng-if="!value.href">
            <div class="truncate">
              <md-tooltip md-direction="top" class="fix-placement" text-overflow-tooltip md-visible="false">{{value.text}}</md-tooltip>
              {{value.text}}
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <div flex ng-if="$ctrl.photos">
      <div class>
        <img src="{{$ctrl.photos[0].extUrl}}" />
      </div>
      <!-- <ng-image-gallery images="$ctrl.photos" thumbnails="true" thumb-size="80" inline="true"
        bubble-size="integer | model" img-bubbles="true" img-anim="fadeup" on-open="$ctrl.inlineGallery = false"
        on-close="$ctrl.inlineGallery = true"></ng-image-gallery> -->
    </div>
  </div>

  <md-divider ng-if="$ctrl.auxiliaryRecordDetails(0) !== '{}'"></md-divider>

  <div class="auxiliary-details" ng-if="$ctrl.auxiliaryRecordDetails(0) !== {}" layout="row">
    <table flex="100" flex-gt-sm="50" class="table table-condensed">
      <tbody>
        <tr ng-repeat="(key, value) in $ctrl.auxiliaryRecordDetails(0) track by key">
          <th>{{key}}:</th>
          <td>
            <div class="truncate">
              <md-tooltip md-direction="top" class="fix-placement" text-overflow-tooltip md-visible="false">{{value}}</md-tooltip>
              {{value}}
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <table flex="100" flex-gt-sm="50" class="table table-condensed">
      <tbody>
        <tr ng-repeat="(key, value) in $ctrl.auxiliaryRecordDetails(1) track by key">
          <th>{{key}}:</th>
          <td>
            <div class="truncate">
              <md-tooltip md-direction="top" class="fix-placement" text-overflow-tooltip md-visible="false">{{value}}</md-tooltip>
              {{value}}
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <md-divider ng-if="$ctrl.parentDetail"></md-divider>

  <div class="parent-details" ng-if="$ctrl.parentDetail">
    <h3>Parent {{$ctrl.parent.event}}</h3>
    <div layout="row">
      <dl>
        <dt ng-repeat-start="(key, value) in $ctrl.parentDetail track by key">{{key}}:</dt>
        <span ng-if="!value.href">{{value.text || 'N/A'}}</span>
        <span ng-if="value.href">
          <a href="{{value.href}}" target="_blank">{{value.text || 'N/A'}}</a>
        </span>
      </dl>
    </div>
  </div>


  <md-divider ng-if="$ctrl.childDetails"></md-divider>

  <div class="child-details" ng-if="$ctrl.childDetails">
    <h3>Child Entities</h3>
    <div class="entity-group" ng-repeat="(entity, children) in $ctrl.childDetails track by entity">
      <div layout="row" ng-repeat="child in children track by $index">
        <span class="entity">{{entity}}</span>
        <dl flex layout="row">
          <dt ng-repeat-start="(key, value) in child track by key">{{key}}:</dt>
          <dd ng-repeat-end>
            <span ng-if="!value.href">{{value.text || 'N/A'}}</span>
            <span ng-if="value.href">
              <a href="{{value.href}}" target="_blank">{{value.text || 'N/A'}}</a>
            </span>
          </dd>
        </dl>
      </div>
    </div>
  </div>