<div class="settings">
    <fims-project-config-navbar
            show-save="$ctrl.showSave"
            on-save="$ctrl.handleOnSave()"
            add-text="Field"
            on-add="$ctrl.handleOnAdd()">
    </fims-project-config-navbar>

    <div class="row back">
        <div class="col-xs-12">
            <a href ui-sref="project.config.lists"> <i class="fa fa-chevron-left"></i>
                Lists</a>
        </div>
    </div>

    <table class="table attributes-table">
        <thead>
            <th></th>
            <th>Value</th>
            <th>Defined By</th>
            <th>Definition</th>
        </thead>

        <tbody>
            <tr ng-repeat="field in $ctrl.list.fields track by $index"
                id="field_{{ $index }}"
                uib-popover-template="'editField.html'"
                popover-is-open="$index===$ctrl.editField"
                popover-placement="auto bottom"
                popover-trigger="none"
                popover-class="edit-popover">
                <td class="row-actions">
                    <a href="#" ng-click="$ctrl.handleToggleEdit($index)"><i class="fa fa-pencil fa-fw"></i></a>
                    <a href="#" class="delete" ng-click="$ctrl.handleOnDelete($index)"><i
                            class="fa fa-trash text-danger fa-fw"></i></a>
                </td>
                <td ng-click="$ctrl.handleToggleEdit($index)">{{ field.value }}</td>
                <td ng-click="$ctrl.handleToggleEdit($index)">{{ field.defined_by }}</td>
                <td ng-click="$ctrl.handleToggleEdit($index)">{{ field.definition }}</td>
            </tr>
        </tbody>
    </table>
</div>

<script type="text/ng-template" id="editField.html">
    <fims-edit-field
            field="field"
            fields="$ctrl.list.fields"
            on-update="$ctrl.handleOnUpdate($index, field)"
            on-close="$ctrl.handleToggleEdit($index)">
    </fims-edit-field>
</script>
